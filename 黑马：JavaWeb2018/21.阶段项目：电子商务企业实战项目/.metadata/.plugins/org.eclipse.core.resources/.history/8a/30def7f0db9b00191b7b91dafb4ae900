package cn.itcast.store.test;

import java.sql.SQLException;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;

import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.handlers.MapListHandler;

import cn.itcast.store.utils.JDBCUtils;

public class TestMapListHandler
{
	// 根据订单的id查询每笔订单下订单项以及订单项对应的商品详情
	
	// SQL分析过程
	// select * from orderitem, product 笛卡尔积
	// select * from orderitem o, product p where o.pid = p.pid 筛选出有意义的数据
	// select * from orderitem o, product p where o.pid = p.pid and oid='asdasdasdad' 最终结果
	public void test00() throws SQLException
	{
		String sql = "select * from orderitem o, product p where o.oid = p.pid and oid='asdasdasdad'";
		QueryRunner qr = new QueryRunner(JDBCUtils.getDataSource());
		// 由于返回的数据是来自多个表的多行数据，用MapListHandler封装数据
		List<Map<String, Object>> list = qr.query(sql, new MapListHandler());
		for (Map<String, Object> map : list)
		{
			// 输出map中的内容
			for (Map.Entry<String, Object> entry : map.entrySet())
			{
				System.out.println(entry.getKey() + ": " + entry.getValue());
			}
		}
	}
	
}
